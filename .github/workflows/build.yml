name: Android Build (assembleDebug)

on:
  push:
    branches: [ main, master ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    timeout-minutes: 60

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4
        # ID: checkout -- yeh action output generate karta hai

      - name: Set up JDK 17 & Configure Gradle
        uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: '17'
          cache: 'gradle' 

      # -- Yahan permission set ho chuki hai, aur yeh step abhi bhi zaroori hai --
      - name: Grant execute permission for gradlew
        run: chmod +x gradlew
        if: success() && hashFiles('gradlew') != '' 
        # Yeh step pehle bhi chala tha, ab phir chalega.

      # === Yahan humne 'gradle-build-action' ko hata diya hai ===
      - name: Run Gradle assembleDebug (Native Command)
        # Seedhe './gradlew' command use karein. Yeh sabse zyada reliable hai.
        run: ./gradlew assembleDebug 
        # Agar aapka project root folder mein nahi hai, toh 'cd' command use karna pad sakta hai.
        # Lekin agar aapka build.gradle root mein hai, toh yahi kaam karega.

      - name: Upload debug APK
        uses: actions/upload-artifact@v4
        with:
          name: app-debug-apk
          path: app/build/outputs/apk/debug/*.apk
