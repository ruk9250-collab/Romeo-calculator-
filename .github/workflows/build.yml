name: Android Build (assembleDebug)

on:
  push:
    branches: [ main, master ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    timeout-minutes: 60

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      # JDK Setup aur Gradle Action ab ek hi step mein zyada behtar tarah se handle hote hain
      - name: Set up JDK 17 & Configure Gradle
        uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: '17'
          # Cache karne ke liye yeh line add ki hai, jo performance badhaati hai.
          cache: 'gradle' 

      # Permssion ka masla hal karne ke liye yeh step zaroori hai.
      - name: Grant execute permission for gradlew
        run: chmod +x gradlew
        # Agar gradlew file maujood na ho (kisi wajah se), toh yeh step skip ho jaayega aur fail nahi hoga.
        if: success() && steps.checkout.outcome == 'success' && hashFiles('gradlew') != '' 
        # Note: Aapka pehla 'Ensure gradlew is executable' step bhi theek tha, 
        # lekin yeh tareeqa zyada standard hai.

      - name: Run Gradle assembleDebug
        # Humne pehle hi JDK set kar diya hai, toh ab hum sirf 'run' command istemaal kar sakte hain.
        # Lekin, aapka pehle wala 'gradle/gradle-build-action@v2' use karna bhi bilkul theek hai.
        # Main aapke liye yahan par aapka originally use kiya gaya action hi rakhta hoon.
        uses: gradle/gradle-build-action@v2
        with:
          arguments: assembleDebug

      - name: Upload debug APK
        uses: actions/upload-artifact@v4
        with:
          name: app-debug-apk
          path: app/build/outputs/apk/debug/*.apk

